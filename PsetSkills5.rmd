---
title: "skills_ps_5"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(forcats)
library(dplyr)
library(ggplot2)
library(naniar)

levels(gss_cat$rincome)
```

1.1



```{r}

ggplot(gss_cat,aes(x=rincome))+
geom_bar()+
coord_flip()
```

The prolem is that the categorial variable is not ordered.  this can be fixed by using fct_infreq():




One way to fix it 

```{r}
ggplot(gss_cat, aes(x = fct_infreq(rincome))) + 
  geom_bar() + 
  coord_flip()
```
1.2

  
```{r}
gss_cat %>%
  mutate(lump = fct_lump(rincome, n = 5)) %>%
  ggplot(aes(x=fct_infreq(lump)))+
  geom_bar()+ 
  coord_flip()
```
1.3.a



```{r}

gss_cat
ggplot(gss_cat, aes(x = (tvhours))) + 
  geom_bar() + 
  coord_flip()
```


```{r}

```




```{r}
ggplot(gss_cat, mapping = aes(x=relig, y=tvhours))+
    geom_boxplot()+ 
    theme(axis.text.x=element_text(angle=-45))
```
We consider the number outliers that are above 18 hours to be suspect as normal people need to sleep.  it might make sens to remove these.






```{r}

```





This 
option 3: winsorize


option 1: drop
The problem is that this removes the data and it is possible that we want to us it later. 

```{r}

relig_summary <- gss_cat %>%
  group_by(relig) %>%
  filter(tvhours<=18) %>% 
  summarise(
    tvhours = mean(tvhours, na.rm = TRUE),
    n = n()
  )
ggplot(relig_summary, aes(tvhours, fct_reorder(relig,tvhours))) + geom_point()

```
option 2: set missing

```{r}
install.packages("naniar")
library(naniar)
relig_summary <- gss_cat %>%
  replace_with_na(replace=list(gss_cat$tvhours>=18))%>%
  group_by(relig) %>%
  summarise(
    age = mean(age, na.rm = TRUE),
    tvhours = mean(tvhours, na.rm = TRUE),
    n = n()
  )
ggplot(relig_summary, aes(tvhours, fct_reorder(relig,tvhours))) + geom_point()

```
Dont know what winsorize means


1.3.c



```{r}
gss_cat$error <- qt(0.975,df=length(gss_cat$tvhours)-1)*sd(gss_cat$tvhours,na.rm=TRUE)/sqrt(length(gss_cat$tvhours))




LOWER95<-mean(gss_cat$tvhours,na.rm=TRUE)-gss_cat$error

HIGHER95<-mean(gss_cat$tvhours, na.rm=TRUE)+gss_cat$error


tvhours
```


```{r}



relig_summary <- gss_cat %>%
  group_by(relig) %>%
  summarise(
    tvhours_mean = mean(tvhours, na.rm = TRUE),
    error = qt(0.975,df=length(tvhours)-1)*sd(tvhours,na.rm=TRUE)/sqrt(length(tvhours)),
    LOWER95=mean(tvhours,na.rm=TRUE)-error,
    HIGHER95 =mean(tvhours, na.rm=TRUE)+error,
    n = n()
  )

relig_summary

ggplot(relig_summary)+
  
      geom_linerange(mapping=aes(x=relig,ymin=LOWER95,ymax=HIGHER95), colour='black') +
      geom_point(mapping=aes(x=relig,y=tvhours_mean))+
      theme(axis.text.x=element_text(angle=-45))

```
